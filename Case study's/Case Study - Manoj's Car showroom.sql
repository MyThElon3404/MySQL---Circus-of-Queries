-- =====================================================================
-- case study - Manoj's Car showroom
-- sample Schema
-- =====================================================================
DROP TABLE IF EXISTS cars;
CREATE TABLE cars (
	car_id INT PRIMARY KEY,
	make VARCHAR(50),
	type VARCHAR(50),
	style VARCHAR(50),
	cost_$ INT
);
INSERT INTO cars (car_id, make, type, style, cost_$)
VALUES 
(1, 'Honda', 'Civic', 'Sedan', 30000),
(2, 'Toyota', 'Corolla', 'Hatchback', 25000),
(3, 'Ford', 'Explorer', 'SUV', 40000),
(4, 'Chevrolet', 'Camaro', 'Coupe', 36000),
(5, 'BMW', 'X5', 'SUV', 55000),
(6, 'Audi', 'A4', 'Sedan', 48000),
(7, 'Mercedes', 'C-Class', 'Coupe', 60000),
(8, 'Nissan', 'Altima', 'Sedan', 26000);

-- ---------------------------------------------------------------------

DROP TABLE IF EXISTS salespersons;
CREATE TABLE salespersons (
	salesman_id INT PRIMARY KEY,
	name VARCHAR(50),
	age INT,
	city VARCHAR(50)
);
INSERT INTO salespersons (salesman_id, name, age, city)
VALUES 
(1, 'John Smith', 28, 'New York'),
(2, 'Emily Wong', 35, 'San Fran'),
(3, 'Tom Lee', 42, 'Seattle'),
(4, 'Lucy Chen', 31, 'LA');

-- ---------------------------------------------------------------------

DROP TABLE IF EXISTS sales;
CREATE TABLE sales (
	sale_id INT PRIMARY KEY,
	car_id INT,
	salesman_id INT,
	purchase_date DATE,
	FOREIGN KEY (car_id) REFERENCES cars(car_id),
	FOREIGN KEY (salesman_id) REFERENCES salespersons(salesman_id)
);
INSERT INTO sales (sale_id, car_id, salesman_id, purchase_date)
VALUES 
(1, 1, 1, '2021-01-01'), (2, 3, 3, '2021-02-03'),
(3, 2, 2, '2021-02-10'), (4, 5, 4, '2021-03-01'),
(5, 8, 1, '2021-04-02'), (6, 2, 1, '2021-05-05'),
(7, 4, 2, '2021-06-07'), (8, 5, 3, '2021-07-09'),
(9, 2, 4, '2022-01-01'), (10, 1, 3, '2022-02-03'),
(11, 8, 2, '2022-02-10'), (12, 7, 2, '2022-03-01'),
(13, 5, 3, '2022-04-02'), (14, 3, 1, '2022-05-05'),
(15, 5, 4, '2022-06-07'), (16, 1, 2, '2022-07-09'),
(17, 2, 3, '2023-01-01'), (18, 6, 3, '2023-02-03'),
(19, 7, 1, '2023-02-10'), (20, 4, 4, '2023-03-01');

-- =====================================================================
-- case study Questions and Answers
-- =====================================================================

-- Q1. what are ths details of the car purchased in the year 2022 ?
select c.*, YEAR(purchase_date) as year_2022
from cars as c
inner join sales as s
	on c.car_id = s.car_id
where YEAR(purchase_date) = 2022
order by c.car_id;

-- Q2. what are the total numbers of car sold by each salesperson?
select salesman_id,
	count(car_id) as total_number_of_car_sold
from sales
group by salesman_id
order by salesman_id;

-- Q3. what is the total revenue generated by each salesperson
select s.salesman_id,
	sum(cost_$) as total_revenue_$
from sales as s
inner join cars as c
  on s.car_id = c.car_id
group by s.salesman_id;

-- Q4. what are the details of each car sold by salesperson
select s.salesman_id,
	c.*
from cars as c
inner join sales as s
	on c.car_id = s.car_id
order by s.salesman_id, c.car_id;

-- Q5. what is total revenue generated by each car type
select c.type,
	sum(cost_$) as total_revenue_$
from cars as c
inner join sales as s
	on c.car_id = s.car_id
group by c.type
order by total_revenue_$ desc;

















